{% extends 'base.html.twig' %}

{% block title %}Intervention{% endblock %}

{% block body %}
    <h1>Intervention</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ intervention.id }}</td>
            </tr>
            <tr>
                <th>DateCreation</th>
                <td>{{ intervention.dateCreation ? intervention.dateCreation|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>DateIntervention</th>
                <td>{{ intervention.dateIntervention ? intervention.dateIntervention|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>TypeIntervention</th>
                <td>{{ intervention.typeIntervention.value }}</td>
            </tr>
            <tr>
                <th>Statut</th>
                <td>{{ intervention.statut.value }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ intervention.description }}</td>
            </tr>
            <tr>
                <th>TempsFacturableMinutes</th>
                <td>{{ intervention.tempsFacturableMinutes }}</td>
            </tr>
            <tr>
                <th>TempsReelMinutes</th>
                <td>{{ intervention.tempsReelMinutes }}</td>
            </tr>
            {% if is_granted('ROLE_ADMIN') %}
            <tr>
                <th>Facturable</th>
                <td>{{ intervention.facturable is null ? 'Non validé (en attente)' : (intervention.facturable ? 'Oui, à facturer' : 'Non, ne pas facturer') }}</td>
            </tr>
            {% endif %}
            {% if intervention.typeIntervention.value == 'livraison_toner' %}
            <tr>
                <th>Mouvement de stock</th>
                <td>{{ intervention.stockApplique ? 'Appliqué (stock entreprise débité, stock site crédité)' : 'En attente de clôture' }}</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    {% if intervention.lignes|length > 0 %}
    <h2 class="h5 mt-4">Pièces à livrer</h2>
    <table class="table table-sm">
        <thead>
            <tr>
                <th>Pièce</th>
                <th>Référence</th>
                <th>Quantité</th>
            </tr>
        </thead>
        <tbody>
            {% for ligne in intervention.lignes %}
            <tr>
                <td>{{ ligne.piece.designation }}</td>
                <td>{{ ligne.piece.reference }}</td>
                <td>{{ ligne.quantite }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    <a href="{{ path('app_intervention_index') }}">back to list</a>

    <a href="{{ path('app_intervention_edit', {'id': intervention.id}) }}">edit</a>

    {{ include('intervention/_delete_form.html.twig') }}
{% endblock %}
